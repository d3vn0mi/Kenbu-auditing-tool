{% extends "base.html" %}
{% block title %}{{ section.number }} {{ section.title }} - Kenbu{% endblock %}
{% block content %}
<!-- Breadcrumb -->
<nav class="flex mb-4" aria-label="Breadcrumb">
    <ol class="flex items-center space-x-2 text-sm text-gray-500">
        <li><a href="{{ url_for('benchmarks.list_benchmarks') }}" class="hover:text-gray-700">Benchmarks</a></li>
        <li><span class="mx-1">/</span></li>
        <li><a href="{{ url_for('benchmarks.detail', benchmark_id=benchmark.id) }}" class="hover:text-gray-700">{{ benchmark.name }}</a></li>
        {% for crumb in breadcrumb %}
        <li><span class="mx-1">/</span></li>
        {% if loop.last %}
        <li class="text-gray-900 font-medium">{{ crumb.number }} {{ crumb.title }}</li>
        {% else %}
        <li><a href="{{ url_for('benchmarks.section', benchmark_id=benchmark.id, section_id=crumb.id) }}" class="hover:text-gray-700">{{ crumb.number }}</a></li>
        {% endif %}
        {% endfor %}
    </ol>
</nav>

<div class="mb-6 flex items-center justify-between">
    <div>
        <h1 class="text-2xl font-bold text-gray-900">{{ section.number }} {{ section.title }}</h1>
        <p class="mt-1 text-sm text-gray-500">{{ checks|length }} checks</p>
    </div>
    <a href="{{ url_for('export.export_benchmark', benchmark_id=benchmark.id) }}" hx-boost="false"
       class="inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-500">
        <svg class="mr-1.5 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
        </svg>
        Export All
    </a>
</div>

{% if section.description %}
<div class="bg-white shadow rounded-lg p-4 mb-6">
    <p class="text-sm text-gray-700">{{ section.description }}</p>
</div>
{% endif %}

<!-- Child sections -->
{% if section.children.count() > 0 %}
<div class="mb-6 space-y-2">
    {% for child in section.children.all()|sort(attribute='sort_order') %}
    <a href="{{ url_for('benchmarks.section', benchmark_id=benchmark.id, section_id=child.id) }}"
       class="block bg-white shadow rounded-lg px-6 py-3 hover:shadow-md transition-shadow">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <span class="text-sm font-mono text-gray-400">{{ child.number }}</span>
                <span class="text-sm font-medium text-gray-900">{{ child.title }}</span>
            </div>
            <div class="flex items-center space-x-2">
                <span class="text-xs text-gray-500">{{ child.total_checks }} checks</span>
                <svg class="h-4 w-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                </svg>
            </div>
        </div>
    </a>
    {% endfor %}
</div>
{% endif %}

<!-- Checks table -->
{% if checks %}
<div class="bg-white shadow rounded-lg overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase w-24">Check #</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Title</th>
                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase w-16">Level</th>
                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase w-20">Scored</th>
                <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase w-16"></th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for check in checks %}
            <tr class="hover:bg-gray-50 {% if check.level == 2 %}bg-yellow-50{% endif %}">
                <td class="px-4 py-3 whitespace-nowrap text-sm font-mono text-gray-500">{{ check.check_number }}</td>
                <td class="px-4 py-3">
                    <a href="{{ url_for('checks.detail', check_id=check.id) }}" class="text-sm text-gray-900 hover:text-primary-600">{{ check.title }}</a>
                </td>
                <td class="px-4 py-3 text-center">
                    <span class="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium {% if check.level == 1 %}bg-blue-100 text-blue-700{% else %}bg-yellow-100 text-yellow-700{% endif %}">L{{ check.level }}</span>
                </td>
                <td class="px-4 py-3 text-center">
                    {% if check.scored %}
                    <span class="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700">Yes</span>
                    {% else %}
                    <span class="inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-600">No</span>
                    {% endif %}
                </td>
                <td class="px-4 py-3 text-center">
                    <a href="{{ url_for('checks.detail', check_id=check.id) }}" class="text-primary-600 hover:text-primary-800">
                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
                        </svg>
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
